function bookLoad(){$.ajax({type:"GET",url:book_dir+"book.json?v=2017",dataType:"json",success:function(t){book_list=t,total=parseInt(book_list._total),$("#book-page-total").html("共"+total+"页"),bookMove(book_cur)}})}function bookMove(t){cur_page=parseInt(t),cur_page<=1?(cur_page=1,$(".book-prev").hide()):$(".book-prev").show(),cur_page>=total?(cur_page=total,$(".book-next").hide()):$(".book-next").show(),cur_name=book_list[cur_page],$("#book-page-num").val(cur_page),$(".book-frame").html(""),$(".book-frame").html("<img src='"+book_dir+"s/"+cur_name+".jpg' rel='"+book_dir+"b/"+cur_name+".jpg'/>")}function bookPrev(){bookMove(cur_page-1)}function bookNext(){bookMove(cur_page+1)}function bookGo(){book_cur=$("#book-page-num").val(),bookMove(book_cur)}function bbimg(t){$(".cboxPhoto:hover").css("cursor","hand");var e=parseInt(t.style.zoom,10)||100;return 0<(e+=event.wheelDelta/12)&&(t.style.zoom=e+"%"),!1}function ajaxConsult(t,e,o){$("#comnent_list").html('<p class="tips-loading"><img src="'+STATIC+'images/spin.gif" /></p>'),$.ajax({type:"GET",url:ROOT+"Api/ajax_comment_list?goods_id="+o+"&type="+t+"&p="+e,success:function(t){$("#comnent_list").html(""),$("#comnent_list").append(t)}})}function check_form_comment(t){var e=$.trim($('input[name="username"]').val()),o=$.trim($('input[name="contact"]').val()),a=$.trim($('textarea[name="content"]').val()),n=$.trim($('input[name="verify"]').val()),s=$.trim($('input[name="goods_id"]').val()),i=$.trim($('input[name="cate_id"]').val());return 0==e.length?(layer.msg("请输入您的称呼！",{icon:2,time:2e3}),!1):0==o.length?(layer.msg("请填输入联系方式!",{icon:2,time:2e3}),!1):0==a.length?(layer.msg("请填输入咨询内容!",{icon:2,time:2e3}),!1):0==n.length?(layer.msg("请填输入验证码!",{icon:2,time:2e3}),!1):void $.ajax({type:"post",url:ROOT+"Api/comment",data:{username:e,contact:o,content:a,verify:n,goods_id:s,cate_id:i},dataType:"json",success:function(t){1==t.status?($("#commt-content").val(""),$("#commt-username").val(""),$("#commt-contact").val(""),$("#commt-verify").val(""),$("#commt-captcha").trigger("click"),layer.msg(t.info,{icon:1,time:2e3})):layer.msg(t.info,{icon:2,time:2e3})}})}function switch_sku(t){$(t).siblings("input").trigger("click"),$(t).parent().parent().parent().find(".spec-item").removeClass("spec-item-checked"),$(t).parent().addClass("spec-item-checked"),$("#sku").val($(t).siblings("input").val()),$("#is_sku").val(1)}function switch_spec(t){$(t).siblings("input").trigger("click"),$(t).parent().parent().parent().find(".spec-item").removeClass("spec-item-checked"),$(t).parent().addClass("spec-item-checked"),send_spec()}function switch_spec_range(t,e,o,a){var n=$("#spec_"+t);if(isNaN(e))n.val("").focus().addClass("border-red"),layer.alert("请输入数字！",{icon:2});else if(""==e)n.val("").focus().addClass("border-red"),layer.alert("请输入数字！",{icon:2});else{arr=o.split("~");e=parseFloat(e);var s=parseFloat(arr[0]),i=parseFloat(arr[1]);e<s||i<e?(n.val("").focus().addClass("border-red"),layer.alert("请输入正确范围！",{icon:2})):"null"!==a&&0!=a&&Math.floor(numDiv(numSub(e,s),a))!=numDiv(numSub(e,s),a)?(n.val("").focus().addClass("border-red"),layer.alert("请输入正确的步进值！",{icon:2})):n.removeClass("border-red")}send_spec()}function send_spec(){$.ajax({type:"POST",url:ROOT+"Api/get_goods_sku",data:$("#buy_goods_form").serialize(),dataType:"json",success:function(t){1==t.status?($("#sku").val(t.sku),$("#sku-text").html(t.sku),$("#is_sku").val(1)):($("#sku").val(""),$("#is_sku").val(0),$("#sku-text").html("待生成..."))}})}function numSub(t,e){var o,a,n;try{a=t.toString().split(".")[1].length}catch(t){a=0}try{n=e.toString().split(".")[1].length}catch(t){n=0}return((t*(o=Math.pow(10,Math.max(a,n)))-e*o)/o).toFixed(n<=a?a:n)}function numMulti(t,e){var o=0;try{o+=t.toString().split(".")[1].length}catch(t){}try{o+=e.toString().split(".")[1].length}catch(t){}return Number(t.toString().replace(".",""))*Number(e.toString().replace(".",""))/Math.pow(10,o)}function numDiv(num1,num2){var baseNum1=0,baseNum2=0,baseNum3,baseNum4;try{baseNum1=num1.toString().split(".")[1].length}catch(t){baseNum1=0}try{baseNum2=num2.toString().split(".")[1].length}catch(t){baseNum2=0}with(Math)return baseNum3=Number(num1.toString().replace(".","")),baseNum4=Number(num2.toString().replace(".","")),baseNum3/baseNum4*pow(10,baseNum2-baseNum1)}function switch_num(t){var e=parseInt($("#goods_num").val());(e+=t)<1&&(e=1),$("#goods_num").val(e)}$(document).ready(function(){$(".goods-con-remark img").click(function(){var t=$(this).attr("src");window.open("https://www.forrun.cn"+t)}),$("#look_manual").click(function(){bookLoad()});var e=0;$("#look_guarantee").click(function(){0==e&&($(".goods-con-guarantee").html('<p class="tips-loading"><img src="'+STATIC+'images/spin.gif" /></p>'),$.ajax({type:"GET",data:{id:2},url:ROOT+"api/get_part_content",timeout:5e3,success:function(t){e=1,$(".goods-con-guarantee").html(t)},error:function(t,e){$(".goods-con-guarantee").html('<p class="tips-error">请求失败！请重试。</p>')}}))});var o=0;$("#look_service").click(function(){0==o&&($(".goods-con-service").html('<p class="tips-loading"><img src="'+STATIC+'images/spin.gif" /></p>'),$.ajax({type:"GET",data:{id:3},url:ROOT+"api/get_part_content",timeout:5e3,success:function(t){o=1,$(".goods-con-service").html(t)},error:function(t,e){$(".goods-con-service").html('<p class="tips-error">请求失败！请重试。</p>')}}))}),$(".goods-con-tab").slide({trigger:"click"});var a=0;$("#look_advantage").click(function(){0==a&&($(".goods-con-advantage").html('<p class="tips-loading"><img src="'+STATIC+'images/spin.gif" /></p>'),$.ajax({type:"GET",data:{id:7},url:ROOT+"api/get_part_content",timeout:5e3,success:function(t){a=1,$(".goods-con-advantage").html(t)},error:function(t,e){$(".goods-con-advantage").html('<p class="tips-error">请求失败！请重试。</p>')}}))}),ajaxConsult(0,1,goods_id)}),$(document).ready(function(){$("#goods_num").bind("contextmenu",contextmenuNum),$("#goods_num").bind("paste",pasteNum),$("#goods_num").bind("keyup",keyupNum),$("#goods_num").bind("blur",blurNum),$("#pro-gallerys li").each(function(t,e){$(e).hover(function(){$(e).siblings().removeClass("current"),$(e).addClass("current"),$("#pro-big").attr("src",$(e).find("img").attr("data-img"))})}),$(".comment-type li").click(function(){$(".comment-type li").removeClass("on"),$(this).addClass("on"),comment_type=$(this).data("type"),goods_id=$(this).data("goods_id"),ajaxConsult(comment_type,1,goods_id)})});