@{
    ViewBag.Title = "轮播图片";
    var F = @Html.F();
}

@using Masuit.Tools.Reflection
@model IEnumerable<lxsShop.ViewModel.bannerViewModel>

@section head {



}


@section body {


    @(
        F.Panel().ID("Panel1").BodyPadding(5).ShowBorder(false).Layout(LayoutType.VBox).ShowHeader(true).Title("轮播图片").IsViewPort(true)
            .Items(
                F.Grid().ID("Grid1").BoxFlex(1).ShowBorder(true).ShowHeader(false).EnableCheckBoxSelect(false).DataIDField("ID").DataTextField("Img")
                    .Columns(
                     
                        F.RenderFieldFor(m => m.ID, true).Hidden(true).Width(80),
                        F.RenderFieldFor(m => m.BannerOrder, true).Width(170),
                        F.RenderFieldFor(m => m.Title, true).Width(200),
                        F.RenderFieldFor(m => m.BackgroundColor, true).Width(150),
                      
                        F.RenderFieldFor(m => m.Img, true).Width(200).Hidden(true),
                        F.RenderField().HeaderText("滚动图片").EnableHeaderMenu(false).EnableColumnHide(false).DataField("Img").RendererFunction("renderLogo").Width(100),
                        F.RenderFieldFor(m => m.URL, true).Width(480),
                                F.RenderField().HeaderText("").EnableHeaderMenu(false).EnableColumnHide(false).RendererFunction("renderActionEdit").Width(50),
                        F.RenderField().HeaderText("").EnableHeaderMenu(false).EnableColumnHide(false).RendererFunction("renderActionDelete").Width(50)

                          )

                            .Toolbars(
                        F.Toolbar().ID("Toolbar1").Position(ToolbarPosition.Top)
                            .Items(
                                F.ToolbarFill(),
                                F.Button().ID("btnNew").Icon(Icon.Add).Text("新增").Listener("click", "onNewClick")
                            )
                    )
                    .DataSource(Model)

            )
    )
    @(F.Window().ID("Window1").IsModal(true).Hidden(true).Target(Target.Top).EnableResize(true).EnableMaximize(true).EnableIFrame(true).Width(800).Height(325).OnClose(Url.Action("DoPostBack"), "Panel1"))

}




@section script {

    <script>

        var coreDeptEdit ='';
        var coreDeptDelete ='';

        function onNewClick(event) {
            F.ui.Window1.show('@Url.Content("~/Admin/Banner/New")', '新增');
        }

        function renderActionEdit(value, params) {
            var imageUrl = '@Url.Content("~/res/icon/pencil.png")';
            var disabledCls =  '';
            return '<a class="action-btn edit '+ disabledCls +'"  href="javascript:;"><img class="f-grid-cell-icon" src="' + imageUrl + '"></a>';
        }

        function renderActionDelete(value, params) {
            var imageUrl = '@Url.Content("~/res/icon/delete.png")';
            var disabledCls =  '';
            return '<a class="action-btn delete'+ disabledCls +'" href="javascript:;"><img class="f-grid-cell-icon" src="' + imageUrl + '"></a>';
        }

        function renderLogo(value, params) {
            var imageUrl = F.baseUrl + 'uploads/' + value;
            return F.formatString('<a href="{0}"  target="_blank"> <img class="f-grid-imagefield" src="{0}"/></a>', imageUrl);


         //   return '<a href="javascript:;" class="mywindowfield"><img class="f-grid-cell-icon" src="@Url.Content("~/res/icon/pencil.png")"></a>';
        }

        F.ready(function () {

            var grid1 = F.ui.Grid1;
            grid1.el.on('click', 'a.action-btn', function (event) {
                var cnode = $(this);
                var rowData = grid1.getRowData(cnode.closest('.f-grid-row'));

                // 是否禁用
                if(cnode.hasClass('f-state-disabled')) {
                    return;
                }

                if (cnode.hasClass('delete')) {
                    F.confirm({
                        message: '确定删除此记录？',
                        target: '_top',
                        ok: function () {
                            // 触发后台事件
                            F.doPostBack('@Url.Action("DoPostBack")', 'Panel1', {
                                actionType: 'delete',
                                deletedRowID: rowData.id
                            });
                        }
                    });
                } else if (cnode.hasClass('edit')) {
                    F.ui.Window1.show('@Url.Content("~/Admin/Banner/Edit?id=")' + rowData.id, '编辑');
                }
            });

        });

    </script>
}